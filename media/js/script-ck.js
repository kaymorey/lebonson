$(document).ready(function(){function e(e){var t=e.parent().attr("data-id"),n=0,r=0;$.ajax({url:"cart.php",type:"GET",data:{remove:t}}).done(function(e){if(!(e>0)){$("header .badge").text("");$("div.cart").html("<h3>Mon panier</h3><p>Votre panier est vide.</p>");return}$("header .badge").text(e)});e.parent().parent().hide("slow",function(){$("table.cart tr:visible .td-total-price").find(".total-price").each(function(){n=parseFloat($(this).text());r+=n;totalPrice=r.toFixed(2)});$("div.cart .summary .total-price-cart").text(r)})}$(".fancy-remove").click(function(){var e=$(this).attr("href");$.fancybox.open({href:e,type:"ajax",closeBtn:!1,afterShow:function(){$(".remove-container .btn-danger").click(function(){$.fancybox.close();return!1});$(".remove-container .btn-info").click(function(){$.ajax({url:$(this).attr("href"),type:"POST",success:function(){window.location="index.php?remove=1"},error:function(){alert("Erreur lors de la suppression");$.fancybox.close()}});return!1})}});return!1});$("#datepicker").datepicker({format:"dd/mm/yyyy",viewMode:"years"});$("table.artists").tablesorter({headers:{4:{sorter:!1}}});$("table.categories").tablesorter({headers:{2:{sorter:!1}}});$("table.orders").tablesorter({headers:{5:{sorter:!1}}});$("table.customers").tablesorter({headers:{3:{sorter:!1}}});$("table.products").tablesorter({headers:{0:{sorter:!1},5:{sorter:!1}}});$(".fancy-add-cart").click(function(){var e=$(this).attr("href");$.fancybox.open({href:e,type:"ajax",closeBtn:!1,afterShow:function(){$(".add-cart .actions .order").click(function(){var e=$("header .badge").text();if(e=="")$("header .cart").append('<span class="badge badge-info">1</span>');else{e=parseInt(e)+1;$("header .badge").text(e)}$.fancybox.close();return!1})}});return!1});$("table.cart .change-quantity").click(function(){var t=$("div.cart .summary .total-price-cart").text(),n=$("header .badge").text();t=parseFloat(t);n=parseInt(n);var r=$(this).parent().attr("data-id");if($(this).hasClass("minus")){var i=$(this).next(".quantity").val(),s=$(this).parent().next(".td-price").find(".price").text(),o=0;i=parseInt(i);s=parseFloat(s);if(i>1){i-=1;n-=1;o=i*s;o=o.toFixed(2);t-=s;t=t.toFixed(2);$(this).next(".quantity").val(i);$(this).parent().siblings(".td-total-price").find(".total-price").text(o)}else i==1&&e($(this))}else if($(this).hasClass("plus")){var i=$(this).prev(".quantity").val(),s=$(this).parent().next(".td-price").find(".price").text(),o=0;i=parseInt(i);s=parseFloat(s);t=parseFloat(t);if(i<999){i+=1;n+=1;o=i*s;o=o.toFixed(2);t+=s;t=t.toFixed(2);$(this).prev(".quantity").val(i);$(this).parent().siblings(".td-total-price").find(".total-price").text(o)}}$.ajax({url:"cart.php",type:"GET",data:{changeQuantity:r,quantity:i}});$("div.cart .summary .total-price-cart").text(t);$("header .badge").text(n);return!1});actualQuantity=$("table.cart .quantity").val();$("table.cart .quantity").change(function(){var t=parseInt($(this).val());if(isNaN(t)||t<0||t>999)$(this).val(actualQuantity);else if(t==0)e($(this));else{var n=$(this).parent().attr("data-id"),r=$(this).parent().next(".td-price").find(".price").text(),i=$(this).parent().siblings(".td-total-price").find(".total-price").text(),s=$("div.cart .summary .total-price-cart").text();r=parseFloat(r);i=parseFloat(i);s=parseFloat(s);s-=i;i=t*r;s+=i;s=s.toFixed(2);$(this).parent().siblings(".td-total-price").find(".total-price").text(i);$("div.cart .summary .total-price-cart").text(s);actualQuantity=$("table.cart .quantity").val();$.ajax({url:"cart.php",type:"GET",data:{changeQuantity:n,quantity:t}}).done(function(e){if(!(e>0)){$("div.cart").html("<h3>Mon panier</h3><p>Votre panier est vide.</p>");return}$("header .badge").text(e)})}});$("table.cart .remove-product").click(function(){e($(this));return!1});$("div.cart .summary form .submit").click(function(){if($("div.cart .summary form .conditions").is(":checked")==0&&$("div.cart .alert-error").length==0){$("div.cart .breadcrumb").after('<div class="alert alert-error">Veuillez accepter les conditions générales de vente.</div>');return!1}});$("form.address fieldset.billing").hide();$("form.address input.different-billing").click(function(){$("form.address fieldset.billing").toggle()})});